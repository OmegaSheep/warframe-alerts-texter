<!DOCTYPE html>
<html>
<link rel="shortcut icon" href="favicon.ico" />
<head>
  <% include ../partials/header.ejs %>
</head>

<body>

  <% include ../partials/nav.ejs %>

<div class="jumbotron text-center">
  <div class="container">
    <a href="/" class="lang-logo">
      <img src="/lang-logo.png">
    </a>
    <h1>Warframe Text Alerts</h1>
    <p>This is a sample application I made that sends me a text message when certain items become available in the video game Warframe. UNDER CONSTRUCTION.</p>
    <a type="button" class="btn btn-lg btn-default" href="https://www.warframe.com/"><span class="glyphicon glyphicon-flash"></span>What is Warframe?</a>
  </div>
</div>
<div class="container">
  <!--
  <div class="alert alert-info text-center" role="alert">
    Lorem Ipsum
  </div>
  <hr>-->
  <div class="row">
    <div class="col-md-6">
      <h3><span class="glyphicon glyphicon-info-sign"></span> Items Being Watched</h3>
      <ul>
        <li>Item 1</li>
        <li>Item 2</li>
        <li>Item 3</li>
      </ul>
    </div>
    <div class="col-md-6">
      <h3><span class="glyphicon glyphicon-info-sign"></span> Last Alert Sent</h3>

      <span id="latestTweet" v-html="tweetHTML">
        {{ tweetHTML }}
      </span>

    </div>
  </div> <!-- row -->
  <div class="alert alert-info text-center" role="alert">
      Placeholder Text
  </div>
</div>

</body>

<script src="/socket.io/socket.io.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script>
  $(document).ready(function() {
    //https://www.html5rocks.com/en/tutorials/frameworks/angular-websockets/?redirect_from_locale=fr - for later when we switch to angular.
    var socket = io.connect('https://warframe-texter-alerts.herokuapp.com/', { forceNew: true, multiplex: false });
    var tweetData = { tweetHTML: null }

    var tweetVue = new Vue({
      el: '#latestTweet',
      data: tweetData
    });

    socket.on('connection', function(msg){
      console.log("Connection received: "+msg);
      socket.on('displayedTweetHTML', function(data){
        console.log("Received: "+JSON.stringify(data));
        tweetData.tweetHTML = data['displayedTweetHTML'];
        //$('#latestTweet').html(data['displayedTweetHTML'];);
      });
    });

  });
</script>

</html>
